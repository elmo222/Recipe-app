<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vibe Recipes - Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <h1>üçΩÔ∏è Vibe Recipes - System Test</h1>
    
    <div id="test-results"></div>
    
    <script>
        const testResults = document.getElementById('test-results');
        
        function addTest(name, success, message) {
            const div = document.createElement('div');
            div.className = `test-section ${success ? 'success' : 'error'}`;
            div.innerHTML = `<h3>${name}</h3><p>${message}</p>`;
            testResults.appendChild(div);
        }
        
        function addInfo(name, message) {
            const div = document.createElement('div');
            div.className = 'test-section info';
            div.innerHTML = `<h3>${name}</h3><p>${message}</p>`;
            testResults.appendChild(div);
        }
        
        // Test browser compatibility
        addTest('IndexedDB Support', 
            'indexedDB' in window, 
            'indexedDB' in window ? 'IndexedDB is supported' : 'IndexedDB is not supported - app will not work');
            
        addTest('Service Worker Support', 
            'serviceWorker' in navigator, 
            'serviceWorker' in navigator ? 'Service Workers supported' : 'Service Workers not supported - offline features unavailable');
            
        addTest('File API Support', 
            'FileReader' in window, 
            'FileReader' in window ? 'File API supported for image uploads' : 'File API not supported - image uploads may not work');
            
        addTest('Fetch API Support', 
            'fetch' in window, 
            'fetch' in window ? 'Fetch API supported for URL imports' : 'Fetch API not supported - URL imports may not work');
            
        addTest('Local Storage Support', 
            'localStorage' in window, 
            'localStorage' in window ? 'Local Storage supported' : 'Local Storage not supported');
            
        // Test CSS features
        addTest('CSS Grid Support', 
            CSS.supports('display', 'grid'), 
            CSS.supports('display', 'grid') ? 'CSS Grid supported' : 'CSS Grid not supported - layout may be broken');
            
        addTest('CSS Flexbox Support', 
            CSS.supports('display', 'flex'), 
            CSS.supports('display', 'flex') ? 'CSS Flexbox supported' : 'CSS Flexbox not supported - layout may be broken');
        
        // Browser info
        addInfo('Browser Information', `
            User Agent: ${navigator.userAgent}<br>
            Platform: ${navigator.platform}<br>
            Language: ${navigator.language}<br>
            Online: ${navigator.onLine ? 'Yes' : 'No'}
        `);
        
        // Test file structure (basic check)
        const testFiles = [
            'styles/main.css',
            'styles/components.css', 
            'js/app.js',
            'js/ui.js',
            'js/storage.js',
            'js/recipe-parser.js',
            'manifest.json',
            'sw.js'
        ];
        
        let fileTestsComplete = 0;
        testFiles.forEach(file => {
            fetch(file)
                .then(response => {
                    addTest(`File: ${file}`, response.ok, 
                        response.ok ? `File loaded successfully (${response.status})` : `File failed to load (${response.status})`);
                })
                .catch(error => {
                    addTest(`File: ${file}`, false, `File failed to load: ${error.message}`);
                })
                .finally(() => {
                    fileTestsComplete++;
                    if (fileTestsComplete === testFiles.length) {
                        addInfo('Test Complete', 'All file structure tests completed. Check results above.');
                    }
                });
        });
        
        // Test basic functionality
        setTimeout(() => {
            try {
                // Test if we can create a basic IndexedDB connection
                const request = indexedDB.open('test-db', 1);
                request.onsuccess = () => {
                    addTest('IndexedDB Connection', true, 'Successfully connected to IndexedDB');
                    request.result.close();
                    indexedDB.deleteDatabase('test-db');
                };
                request.onerror = () => {
                    addTest('IndexedDB Connection', false, 'Failed to connect to IndexedDB');
                };
            } catch (error) {
                addTest('IndexedDB Connection', false, `IndexedDB error: ${error.message}`);
            }
        }, 1000);
        
    </script>
</body>
</html>